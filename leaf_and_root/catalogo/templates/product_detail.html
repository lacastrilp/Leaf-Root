{% extends "base.html" %}
{% load static %}
{% block title %}{{ product.name }}{% endblock %}
<style src="{% static 'carrito/css/cart.css' %}"></style>

{% block content %}
<h1>{{ product.name }}</h1>
{% if product.image_url %}
  <img src="{{ product.image_url }}" alt="{{ product.name }}" width="300">
{% endif %}

<p><strong>Price:</strong> ${{ product.price }}</p>
<p><strong>Stock:</strong> {{ product.stock }}</p>
<p>{{ product.description }}</p>
<form method="post" action="{% url 'add_to_cart' product.pk %}" class="add-to-cart-form">
  {% csrf_token %}
  <input type="hidden" name="quantity" value="1">
  <button type="submit" class="btn btn-sm btn-success">Add to shopping cart</button>
</form>


<h3>Reviews</h3>

{% for review in reviews %}
  <p>
    <b>{{ review.customer.name }}</b>:
    {{ review.comment }} (‚≠ê {{ review.rating }}/5)
  </p>
{% empty %}
  <p>There aren't any reviews yet.</p>
{% endfor %}

{% if user.is_authenticated %}
  <hr>
  <h4>Write your review</h4>
  <form method="post" action="{% url 'submit_review' product.pk %}">
    {% csrf_token %}
    {{ review_form.as_p }}
    <button type="submit" class="btn btn-secondary">Send review</button>
  </form>
{% else %}
  <p class="mt-3">
    <a href="{% url 'login' %}?next={{ request.path }}">Login to write a review</a>
  </p>
{% endif %}
<script src="{% static 'carrito/js/cart.js' %}"></script> <!-- JS global de carrito -->
{% endblock %}
