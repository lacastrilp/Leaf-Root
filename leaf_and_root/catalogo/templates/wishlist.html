{% extends 'base.html' %}

{% load static %}

{% block content %}
<div class="container mt-4">
  <h2 class="fw-bold mb-4">Wishlist</h2>

  {% if items %}
  <div class="row">
    {% for item in items %}
<div class="col-md-4 mb-4">
  <div class="card h-100 shadow-sm">
    {% if item.product.image_url %}
        <a href="{% url 'product_detail' item.product.pk %}" class="product-link">
            <img src="{{ item.product.image_url }}" class="card-img-top" style="height:200px; object-fit:cover;" alt="{{ item.product.name }}">
        </a>
    {% else %}
        <a href="{% url 'product_detail' item.product.pk %}" class="product-link">
            <img src="https://via.placeholder.com/200" class="card-img-top" alt="No image available">
        </a>
    {% endif %}

    <div class="card-body d-flex flex-column">
      <h5 class="card-title">
        <a href="{% url 'product_detail' item.product.pk %}" class="product-link text-dark text-decoration-none">
          {{ item.product.name }}
        </a>
      </h5>
      <p class="card-text text-muted mb-2">
        Price: <strong>${{ item.product.price }}</strong>
      </p>

      <div class="mt-auto">
        <form method="post" action="{% url 'add_to_cart' item.product.pk %}" class="add-to-cart-form d-inline">
          {% csrf_token %}
          <input type="hidden" name="quantity" value="1">
          <button type="submit" class="btn btn-success btn-sm">Add to cart</button>
        </form>

        <form method="post" action="{% url 'toggle_wishlist' item.product.id_product %}" class="d-inline">
          {% csrf_token %}
          <input type="hidden" name="next" value="{{ request.path }}">
          <button type="submit" class="btn btn-danger btn-sm">Remove</button>
        </form>
      </div>
    </div>
  </div>
</div>
{% endfor %}

  </div>
  {% else %}
  <p class="text-muted">Your wishlist is empty.</p>
  {% endif %}
</div>
<script src="{% static 'store/js/product-modal.js' %}"></script> <!-- JS especÃ­fico de wishlist -->
<script src="{% static 'carrito/js/cart.js' %}"></script> <!-- JS global de carrito -->


{% endblock %}