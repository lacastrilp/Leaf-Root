{% extends 'base.html' %}

{% load static %}
{% load i18n %}
{% block content %}
<link rel="stylesheet" href="{% static 'catalogo/css/wishlist.css' %}">
<link rel="stylesheet" href="{% static 'catalogo/css/product_list.css' %}">

<div class="container mt-4">

  <h2 class="landing-title mb-4">{% trans "Wishlist" %}</h2>

  {% if items %}
  <div class="row">
    {% for item in items %}
<div class="col-md-4 mb-4">
  <div class="card h-100 product-card shadow-sm position-relative">
    <!-- Wishlist toggle overlay (filled heart since it's in wishlist) -->
    <form method="post" action="{% url 'toggle_wishlist' item.product.id_product %}" class="wishlist-toggle-form">
      {% csrf_token %}
      <input type="hidden" name="next" value="{{ request.path }}">
      <button type="submit" class="wishlist-button" aria-label="{% trans "Remove from wishlist" %}">
        <i class="bi bi-heart-fill wishlist-icon active"></i>
        <span class="visually-hidden">{% trans "Remove from wishlist" %}</span>
      </button>
    </form>
    {% if item.product.image %}
    <a href="{% url 'product_detail' item.product.pk %}" class="product-link">
      <img src="{{ item.product.image.url }}" class="card-img-top product-image" alt="{{ item.product.name }}">
    </a>
    {% elif item.product.image_url %}
    <a href="{% url 'product_detail' item.product.pk %}" class="product-link">
      <img src="{{ item.product.image_url }}" class="card-img-top product-image" alt="{{ item.product.name }}">
    </a>
    {% else %}
    <a href="{% url 'product_detail' item.product.pk %}" class="product-link">
      <img src="https://via.placeholder.com/400x300?text=No+image" class="card-img-top product-image" alt="No image available">
    </a>
    {% endif %}

    <div class="card-body d-flex flex-column">
      <h5 class="card-title">
        <a href="{% url 'product_detail' item.product.pk %}" class="product-link text-dark text-decoration-none">
          {{ item.product.name }}
        </a>
      </h5>
      <p class="card-text text-muted mb-2">
        {% trans "Price" %}: <strong>${{ item.product.price }}</strong>
      </p>

      <div class="mt-auto">
        <form method="post" action="{% url 'add_to_cart' item.product.pk %}" class="add-to-cart-form d-inline">
          {% csrf_token %}
          <input type="hidden" name="quantity" value="1">
          <button type="submit" class="btn btn-success btn-sm">{% trans "Add to cart" %}</button>
        </form>
      </div>
    </div>
  </div>
</div>
{% endfor %}

  </div>
  {% else %}
  <div class="text-center mb-3">
    <a href="{% url 'home' %}" class="btn btn-secondary">{% trans "Back to Home" %}</a>
  </div>
  <p class="text-muted">{% trans "Your wishlist is empty." %}</p>
  {% endif %}
</div>
<script src="{% static 'store/js/product-modal.js' %}"></script> <!-- JS especÃ­fico de wishlist -->
<script src="{% static 'carrito/js/cart.js' %}"></script> <!-- JS global de carrito -->


{% endblock %}