{% extends "base.html" %}
{% block content %}
<div class="container" style="max-width: 600px; margin-top: 2rem;">
    <h2 class="text-center mb-4" style="font-weight: bold; color: #4CAF50;">Add Product</h2>

    <form method="post" enctype="multipart/form-data" class="shadow p-4 rounded bg-white">
        {% csrf_token %}
        
        <div class="mb-3">
            <label for="id_name" class="form-label">Name</label>
            {{ form.name }}
        </div>

        <div class="mb-3">
            <label for="id_description" class="form-label">Description</label>
            {{ form.description }}
        </div>

        <div class="mb-3">
            <label for="id_price" class="form-label">Price</label>
            {{ form.price }}
        </div>

        <div class="mb-3">
            <label for="id_stock" class="form-label">Stock</label>
            {{ form.stock }}
        </div>

        <div class="mb-3">
            <label for="id_category" class="form-label">Category</label>
            {{ form.category }}
        </div>

        <div class="mb-3">
            <label for="id_image_url" class="form-label">Image URL</label>
            {{ form.image_url }}
        </div>

        <div class="mb-3">
            <label for="id_image" class="form-label">Upload Image</label>
            {{ form.image }}
        </div>

        <div class="mb-3">
            <label for="id_nutriscore" class="form-label">Nutriscore</label>
            {{ form.nutriscore }}
        </div>

        <div class="mb-3">
            <label for="id_labels" class="form-label">Labels</label>
            {{ form.labels }}
        </div>

        <div class="mb-3">
            <label class="form-label">Image Preview:</label><br>
            <img id="preview" 
                src="" 
                alt="Image Preview" 
                style="max-width: 100%; max-height: 200px; object-fit: cover; border:1px solid #ccc; padding:4px; display: none;">
        </div>

        <div class="d-grid">
            <button type="submit" class="btn btn-primary">Save Product</button>
        </div>
    </form>
</div>

<script>
document.getElementById("id_image_url").addEventListener("input", function(event) {
    const preview = document.getElementById("preview");
    if (event.target.value) {
        preview.src = event.target.value;
        preview.style.display = 'block';
    } else {
        preview.style.display = 'none';
    }
});

document.getElementById("id_image").addEventListener("change", function(event) {
    const preview = document.getElementById("preview");
    const file = event.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            preview.src = e.target.result;
            preview.style.display = 'block';
        };
        reader.readAsDataURL(file);
    }
});
</script>
{% endblock %}
